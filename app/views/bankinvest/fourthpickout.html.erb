<%= javascript_include_tag "jquery.dataTables.min.js" %>
<%= stylesheet_link_tag "datatables.css" %>
<%= stylesheet_link_tag "bankinvest.css" %>

<div class="main-contents">
  <table>
    <tr>
      <td class="left">
        <div class="main-inputs">
          <div id="inputs" class="content2">
            <div class="padded">
              <h1>关于银行理财产品</h1>
              <p>这里的银行理财产品是由银行自行设计并发行，而不是作为销售渠道，和信托、基金、保险等金融机构合作的产品。
                <span>这种类型的产品风险极低。</span></p>
            </div>
            <div class="overlay">
              <p class="group">银行</p>
              <input class="input-medium" type="text" name="bcolumn" value="<%= cookies[:bcolumn] %>">
              <p class="group">投入资金</p>
              <input class="input-medium" type="text" name="amount" value="<%= cookies[:amount] %>">
              <p class="group">投资期限</p>
              <input class="input-medium" type="text" name="deadline" value="<%= cookies[:deadline] %>">
              <p class="group">风险性</p>
              <input class="input-medium" type="text" name="risk" value="<%= cookies[:optionsRadios] %>">
            </div>
          </div>
        </div>
      </td>
      <td>
        <div class="main-body">
          <a href="/">首页</a>
          <h2>欢迎</h2>
          <p>我们将根据您输入的实际情况来分析觉得如下几种银行理财产品可能会适合您。<br>
            请您再做仔细筛选：</p>
          <table cellpadding="0" cellspacing="0" border="0" class="display" name="bankfinance" id="bankfinance"  style="text-align:center;">
            <thead><tr>
              <th>发行银行</th><th>产品名称</th><th>投资期限</th><th>当天买的年化收益率</th><th>计算收益金额</th><th>操作</th>
            </tr></thead>

            <% @bankfinances.each do |b| %>
                <tr>
                  <td><%= b.trustee%></td>
                  <td><p class="ctl" title="<%= b.bname%>"><%= b.bname%></p></td>
                  <td><%= format("%0.0f",b.investperiod)%>天</td>
                  <td><%= format("%0.1f",b.returnrate*100)%>%</td>
                  <td><a href="#login-box" class='login-window'title="<%= b.returnrate%>|<%= b.investperiod%>"><img src="/assets/calculator.jpg"></a></td>
                  <td>查看详情</td>
                </tr>
            <% end %>
          </table>
          <br><br>
          <p>同样三个月，一个是预期年化收益4%和4.5%，这里的区别在哪里？<br>A: 直接买4.5%的</p>
        </div>
      </td>
    </tr>
  </table>
</div>

<script>
    $.fn.dataTableExt.afnFiltering.push(
            function( oSettings, aData, iDataIndex ) {
                var flag1,flag2,flag3,flag4;
                var bcolumn= "<%= cookies[:bcolumn] %>";
                var deadline= "<%= cookies[:deadline] %>";
                if(bcolumn==aData[0]){
                    flag1=1;
                }

                if(deadline=="%u77E"&&aData[2]<14){
                    flag2=1;
                }
                else if(deadline=="中期投资 (小于一年)"&&aData[2]>=14&&aData[2]<365){
                    flag2=1;
                }
                else if(deadline=="长期投资 (一年及以上)"&&aData[2]>=365){
                    flag2=1;
                }

                if(flag1==1){
                    return true;
                }

            }
    );
    $(document).ready(function(){
        /* Initialise datatables */
        var oTable = $('#bankfinance').dataTable({
            "iDisplayLength": 50
        });

        $("#returnrate,#bank,#period,#optionsRadios").click( function() { oTable.fnDraw(); } );

    });
</script>