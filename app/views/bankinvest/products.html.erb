<%= stylesheet_link_tag "bankinvest.css" %>
<%= javascript_include_tag "jquery.dataTables.min.js" %>
<%= javascript_include_tag "jquery.dataTables.columnFilter.js" %>

<style>
    #products th,#products td{
        text-align: center;
        font-family: Hiragino Sans GB W3;
    }
    tr.even td.sorting_1 {
        background-color: #ffffff;
    }

    .dataTables_length {
        font: 80% Hiragino Sans GB W3;
        width: 40%;
        margin: 5px;
        float: left;
    }
    .dataTables_filter {
        text-align: right;
    }
    .dataTables_paginate {
        font: 80% Hiragino Sans GB W3;
        float: right;
        text-align: right;
    }
    .paginate_disabled_previous, .paginate_enabled_previous {
        padding-left: 23px;
    }
    .paginate_disabled_previous, .paginate_disabled_next {
        color: #666 !important;
    }
    .paginate_disabled_next, .paginate_enabled_next {
        padding-right: 23px;
        margin-left: 10px;
    }
</style>

<div class="main-content organ">
  <a href="/">首页</a>
  <h1 class="deploy" style="padding-bottom: 0;">理财产品<br>
    <span style="font-size: 14px;">我们为您提供最及时的理财产品信息，供你做选择。</span>
  </h1>
  <div id="optionsRadios">
    <div class="box_sxtj">
      <div class="box_sxtj_top">理财产品－查询</div>
      <div class="box_sxtj_center">
        <dl class="fore" id="category_all">
          <dt id="category-category_all">产品类型:</dt>
          <dd>
            <label class="checkbox inline all">
              <a id="category" class="curr category btn-link currbg">不限</a>
            </label>
            <label class="checkbox inline">
              <a id="category1" class="curr category1 btn-link"> 随存随取型 </a>
            </label>
            <label class="checkbox inline">
              <a id="category2" class="curr category2 btn-link"> 保本型 </a>
            </label>
            <label class="checkbox inline">
              <a id="category3" class="curr category3 btn-link"> 风险型 </a>
            </label>
          </dd>
        </dl>
        <dl class="fore">
          <dt id="category-expectYID">年收益率:</dt>
          <dd>
            <label class="checkbox inline all">
              <a id="expectYID" class="curr expectYID btn-link currbg">不限</a>
            </label>
            <label class="checkbox inline">
              <a id="expectYID1" class="curr expectYID1 btn-link"> 0-3% </a>
            </label>
            <label class="checkbox inline">
              <a id="expectYID2" class="curr expectYID2 btn-link"> 3%-6% </a>
            </label>
            <label class="checkbox inline">
              <a id="expectYID3" class="curr expectYID3 btn-link"> 6%-10% </a>
            </label>
          </dd>
        </dl>
        <dl class="fore" id="duration">
          <dt id="category-duration">风险级别:</dt>
          <dd>
            <label class="checkbox inline all">
              <a id="durations" class="curr duration btn-link currbg">不限</a>
            </label>
            <label class="checkbox inline">
              <a id="duration1" class="curr duration1 btn-link"> 无风险</a>
            </label>
            <label class="checkbox inline">
              <a id="duration2" class="curr duration2 btn-link"> 低风险</a>
            </label>
            <label class="checkbox inline">
              <a id="duration3" class="curr duration3 btn-link"> 中级风险</a>
            </label>
            <label class="checkbox inline">
              <a id="duration4" class="curr duration4 btn-link"> 高风险</a>
            </label>
            <label class="checkbox inline">
              <a id="duration5" class="curr duration5 btn-link"> 极高风险</a>
            </label>
          </dd>
        </dl>
      </div>

      <div class="box_sxtj_bottom">
        <dl class="fore">
          <dt>已选择的筛选条件:&nbsp;</dt>
          <dd id="selected">

            <div id="s-category" class="del hide">
              <h6 class="text" id="st-category" condition="">产品类型:不限</h6>
              <a class="delete" cid="category"></a>
            </div>

            <div id="s-expectYID" class="del hide">
              <h6 class="text" id="st-expectYID" condition="">年收益率:不限</h6>
              <a class="delete" cid="expectYID"></a>
            </div>

            <div id="s-duration" class="del hide">
              <h6 class="text" id="st-duration" condition="">风险级别：不限</h6>
              <a class="delete" cid="duration"></a>
            </div>
          </dd>
        </dl>
      </div>
    </div>
  </div>
  <table class="table table-striped table-bordered" id="products"  cellpadding="0" cellspacing="0" border="0">
    <thead>
    <tr>
      <th rowspan="2">理财产品</th>
      <th rowspan="2">产品名称</th>
      <th rowspan="2">类型</th>
      <th rowspan="2" class="hide">风险级别</th>
      <th rowspan="2">风险级别</th>
      <th colspan="2">近1年</th>
      <th colspan="2">近3年</th>
      <th rowspan="2" class="hide">收益率</th>
    </tr>
    <tr>
      <th>收益率</th>
      <th>排名</th>
      <th>收益率</th>
      <th>排名</th>
    </tr>
    </thead>
    <tfoot class="hide">
    <tr>
      <th rowspan="2">理财产品</th>
      <th rowspan="2">产品名称</th>
      <th rowspan="2">类型</th>
      <th rowspan="2" class="hide">风险级别</th>
      <th rowspan="2">风险级别</th>
      <th>收益率</th>
      <th>排名</th>
      <th>收益率</th>
      <th>排名</th>
      <th rowspan="2" class="hide">收益率</th>
    </tr>
    <tr>
      <th colspan="2">近1年</th>
      <th colspan="2">近3年</th>
    </tr>
    </tfoot>

  <% @financial.each do |f| %>
      <tr>
        <td><%= f.productcode %></td>
          <td class="first"><a href="/bankinvest/productdetails/<%= f.id %>"><%= f.pname %></a></td>
          <td class="first"><%= f.category+'/'+f.classify %></td>
            <% if f.risklevel==1 %><td>无风险</td><td class="hide">1</td>
            <% elsif  f.risklevel==2 %><td>低风险</td><td class="hide">2</td>
            <% elsif  f.risklevel==3 %><td>中级风险</td><td class="hide">3</td>
            <% elsif  f.risklevel==4 %><td>高风险</td><td class="hide">4</td>
            <% elsif  f.risklevel==5 %><td>极高风险</td><td class="hide">5</td>
          <% end %>
        <td><% if f.rate !=nil %><% if f.rate.to_f !=0 %><%= format("%0.2f",f.rate.to_f*100) %>%<% else %>--<% end %><% end %></td>
          <td><% if f.rank !='0' %><%= f.rank %><% else %>--<% end %></td>
        <td><% if f.rate1 !=nil %><% if f.rate1.to_f !=0 %><%= format("%0.2f",f.rate1.to_f*100) %>%<% else %>--<% end %><% end %></td>
        <td><% if f.rank1 !='0' %><%= f.rank1 %><% else %>--<% end %></td>
        <td class="hide"><% if f.rate !=nil %><% if f.rate.to_f !=0 %><%= format("%0.2f",f.rate.to_f*100) %><% else %>--<% end %><% end %></td>
      </tr>
  <% end %>
  </table>

</div>


<script>
    $(document).ready(function(){
        $('#products').dataTable({
            "iDisplayLength": 50,
            "aaSorting": [[ 4, "asc" ]]
        });

        $('#products').dataTable().columnFilter({
            aoColumns: [
                null,
                null,
                { type: "text"},
                null,
                { type: "number" },
                null,
                null,
                null,
                null,
                { type: "number-range" }
            ]
        });
    });

    $("[class*='category']").click(function(){
        $("[class*='category']").removeClass('currbg');
        if(this.id=='category'){$("#search2").val('');$("#s-category").addClass('hide');$("#category").addClass('currbg');}
        else{
            if(this.id=='category1'){$("#search2").val('随存随取型');$("#category1").addClass('currbg');};
            if(this.id=='category2'){$("#search2").val('保本型');$("#category2").addClass('currbg');};
            if(this.id=='category3'){$("#search2").val('风险型');$("#category3").addClass('currbg');};
            $("#s-category").removeClass('hide');
            $("#st-category").html('产品类型:'+$('#'+this.id).html());
        }
        $("#search2").keyup();
    });

    $("[class*='expectYID']").click(function(){
        $("[class*='expectYID']").removeClass('currbg');
        if(this.id=='expectYID'){$("#products_range_from_9").val('');$("#products_range_to_9").val('');$("#s-expectYID").addClass('hide');$("#expectYID").addClass('currbg');}
        else{
            if(this.id=='expectYID1'){$("#products_range_from_9").val('0');$("#products_range_to_9").val('3');$("#expectYID1").addClass('currbg');};
            if(this.id=='expectYID2'){$("#products_range_from_9").val('3');$("#products_range_to_9").val('6');$("#expectYID2").addClass('currbg');};
            if(this.id=='expectYID3'){$("#products_range_from_9").val('6');$("#products_range_to_9").val('10');$("#expectYID3").addClass('currbg');};
            $("#s-expectYID").removeClass('hide');
            $("#st-expectYID").html('年收益率:'+$('#'+this.id).html());
        }
        $("#products_range_from_9").keyup();
    });

    $("[class*='duration']").click(function(){
        $("[class*='duration']").removeClass('currbg');
        if(this.id=='durations'){$("#search4").val('');$("#s-duration").addClass('hide');$("#durations").addClass('currbg');}
        else{
            if(this.id=='duration1'){$("#search4").val('1');$("#duration1").addClass('currbg');};
            if(this.id=='duration2'){$("#search4").val('2');$("#duration2").addClass('currbg');};
            if(this.id=='duration3'){$("#search4").val('3');$("#duration3").addClass('currbg');};
            if(this.id=='duration4'){$("#search4").val('4');$("#duration4").addClass('currbg');};
            if(this.id=='duration5'){$("#search4").val('5');$("#duration5").addClass('currbg');};
            $("#s-duration").removeClass('hide');
            $("#st-duration").html('风险级别:'+$('#'+this.id).html());
        }
        $("#search4").keyup();
    });


    $(".delete").click(function(){
        $('#s-'+$(this).attr("cid")).addClass('hide');
        if($(this).attr("cid")=='category'){
            $("[class*='category']").removeClass('currbg');
            $("#category").addClass('currbg');
            $("#search2").val('');$("#s-category").addClass('hide');
            $("#search2").keyup();
        }
        else if($(this).attr("cid")=='expectYID'){
            $("[class*='expectYID']").removeClass('currbg');
            $("#expectYID").addClass('currbg');
            $("#products_range_from_9").val('');$("#products_range_to_9").val('');$("#s-expectYID").addClass('hide');
            $("#products_range_from_9").keyup();
        }
        else if($(this).attr("cid")=='duration'){
            $("[class*='duration']").removeClass('currbg');
            $("#durations").addClass('currbg');
            $("#search4").val('');$("#s-duration").addClass('hide');
            $("#search4").keyup();
        }
    });
</script>