<%= stylesheet_link_tag "usermanagement.css" %>
<%= javascript_include_tag "highcharts.js" %>

<div class="main-content">
  <div class="trow">
    <div class="main-inputs">
      <div id="inputs" class="content">
        <div id="main-inputs" style="">
          <div class="padded">
            <h3>
              <a href="/">tongtianshun.com</a>
            </h3>
            <p>通天顺家庭理财</p>
          </div>
          <div class="general">
            <div class="input-group plaintext">
              <div style="padding: 10px 5px 10px 20px">
                <%= session[:webusername] %> 首页<br><br>
                <a>家庭资产总值</a><br>
                <a href="/usermanagement/profile">基本信息设置</a><br>
                <%= render "side" %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="main-body">
      <a href="/">首页</a>
      <h1>家庭资产总值</h1>
      <div class="row-fluid">
        <div class="span6">
      <table class="table table-striped table-bordered">
        <thead><tr><th>资产名称</th><th>单位净值</th><th>总市值（元）</th></tr></thead>
        <% @userassetsheet.each do |u| %>
           <tr><td><%= @hash[u.id][0] %></td><td><%= @hash[u.id][1] %></td><td><%= u.asset_value %></td></tr>
        <% end %>
        <tr><td>&nbsp;</td><td></td><td></td></tr>
        <tr><td>总和</td><td>-</td><td><%= @total %></td></tr>
      </table>
    </div>
        <div class="span6">
          <div id="container" style="width: 100%;height: 300px;"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
    var dataarray1=[];
    var dataarray2=[];

    <% @userassetdaily.each do |u| %>
    dataarray1.push('<%= u.date %>')
    dataarray2.push(<%= u.total_account %>)
    <% end %>
    $(function () {
        var chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'line'
            },
            title: {
                text:false
            },
            xAxis: {
                categories: dataarray1,
                labels: {
                    rotation: -45,
                    align: 'right',
                    style: {
                        fontSize: '13px',
                        fontFamily: 'Verdana, sans-serif'
                    }
                }
            },
            yAxis: {
                title: {
                    text: '金额'
                },
                labels : {
                    formatter : function ( ) {
                        return this . value ;
                    }
                }
            },
            tooltip: {
                enabled: false,
                formatter: function() {
                    return '<b>'+ this.series.name +'</b><br/>'+
                            this.x +': '+ this.y +'°C';
                }
            },
            plotOptions: {
                line: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: false
                }
            },
            series: [{
                name: '家庭资产总值',
                data: dataarray2
            }],
            legend: {
                verticalAlign: 'top'
            },
            credits: {
                enabled: false
            }
        });
    });
</script>