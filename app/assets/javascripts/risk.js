function recommendRiskTolerance2(a,b,e,f){a.income=100000;var c=fillDefaultValues(a),a=calcSubjectiveRiskTol(c),c=calcObjectiveRiskTol(c),g=[];-1==a?c=a=0:-1==c&&(c=a);g.push(a);g.push(c);a=combineRiskTols(g);f=Math.round(a*f)/f;return Math.min(e,Math.max(b,f))}
function fillDefaultValues(a){var b={response:"unknown",portfolio:"unknown",concern:"unknown",options:"unknown",angel:"unknown",lnw:0,income:5E4,stability:"A",age:45,goal:"false"},e;for(e in b)if(null!==a[e]&&void 0!==a[e]&&("number"!==typeof a[e]||!isNaN(a[e])))b[e]=a[e];return b}function combineRiskTols(a){return isNaN(a[0])?a[1]:isNaN(a[1])?a[0]:10*(a[0]>a[1]?0.8*a[1]+0.2*a[0]:0.8*a[0]+0.2*a[1])}function isAccredited(a,b){return 1E6<=a||2E5<=b/0.7?!0:!1}
function mapAngel(a){ switch(a.angel){case "true":case "A":case "B":case "C":return 1;case "D":case "E":case "F":case "G":return isAccredited(a.lnw,a.income)?0:-1;default:return-1}}
function calcSubjectiveRiskTol(a){for(var b=[{sellAll:0,sellSome:0.33,keepAll:0.67,buyMore:1,unknown:-1}[a.response],{A:0,B:0.5,C:1,unknown:-1}[a.portfolio],{loss:0,both:0.5,gain:1,unknown:-1}[a.concern],{"true":1,"false":-1,unknown:-1}[a.options],mapAngel(a)],e=0,f=0,a=1,c=0,g=0,d=0;d<b.length;d++)0>b[d]||(g=1,f+=b[d],e+=1,b[d]<a&&(a=b[d]),b[d]>c&&(c=b[d]));b=f/e;1==c-a&&(b*=0.5);return 1==g?b:-1}
function calcObjectiveRiskTol(a){if(0==a.lnw)return-1;var b=projectFundingStatus(a),a=ageDecayFactor(a.age);return 1*a+(1-a)*b}
function projectFundingStatus(a){var b=projectWorkingIncome(a.income,a.age,{A:0.05,B:0.03,C:-0.03,D:-0.05,E:0.05}[a.stability],65,0.02),e=null,e="true"==a.options?a.lnw+3*a.income:a.lnw,f=null,c=null,f=[],g=c=null;if(65>=a.age){for(var d=0;d<=65-a.age;d++)c=0==d?e:f[d-1],"true"==a.goal&&5==d&&(c*=0.5),g=projectSavingRate(b[d]),f.push(1.08*c+b[d]*g);f=0.05*f[f.length-1];c=0.8*Math.max(3E4,a.income)*Math.pow(1.02,65-a.age)}else f=0.05*e,c=0.8*a.income;c=Math.max(c,6E3);c=Math.min(c,24E4);return normalizeFundingStatus(f/
c)}function projectWorkingIncome(a,b,e,f,c){for(var g=[],d=0;d<=f-b;d++)g.push(a*Math.pow(1+c+e,d));return g}function normalizeFundingStatus(a){return 2/(1+Math.exp(-a))-1}function projectSavingRate(a){a=0.019*a/1E4;0.244<=a&&(a=0.244);return a}function ageDecayFactor(a){return 25<=a?1-(a-25)/40:1};
